# Invoice Web MVP - Development Roadmap

> 개발 순서: 프로젝트 초기 설정 → 공통 모듈/컴포넌트 → 핵심 기능 → 추가 기능 → 최적화 및 배포

---

## Phase 1: 프로젝트 초기 설정 (골격 구축)

**예상 소요 시간:** 1일

### 작업 내용
- [ ] Next.js 16 + React 19 + TailwindCSS v4 + shadcn/ui 프로젝트 생성
- [ ] 환경변수 설정 (`.env.local`)
  - `NOTION_API_TOKEN`
  - `NOTION_DATABASE_ID`
  - `ACCESS_TOKEN`
- [ ] 의존성 설치
  - `@notionhq/client`
  - `react-to-print`
  - `zod`
  - `date-fns` (선택)
- [ ] 폰트 및 전역 스타일 설정 (`globals.css`)
- [ ] 프로젝트 폴 구조 생성

### 왜 이 순서로 해야 하는가?
- 모든 후속 작업이 기본 설정에 의존함
- 환경변수와 의존성이 설정되어야 개발 환경 테스트 가능
- 팀원 간 일관된 개발 환경 확보 필요

### 완료 기준
- [ ] `npm run dev` 실행 시 개발 서버 정상 구동
- [ ] shadcn/ui 컴포넌트 하나 이상 정상 렌더링 확인
- [ ] 환경변수가 코드에서 정상적으로 읽혀지는지 확인

---

## Phase 2: 공통 모듈/컴포넌트 개발

**예상 소요 시간:** 1일

### 작업 내용
- [ ] TypeScript 타입 정의 (`src/types/invoice.ts`)
  - `InvoiceItem`, `Invoice`, `InvoiceListItem`, `InvoiceStatus`
- [ ] Notion API 클라이언트 설정 (`src/lib/notion.ts`)
  - 클라이언트 인스턴스 생성
  - Rate limiting 대응 (exponential backoff)
- [ ] 데이터 매퍼 구현 (`src/lib/mapper.ts`)
  - Notion 응답 → TypeScript 타입 변환
  - Zod 스키마 검증
- [ ] 유틸리티 함수 (`src/lib/utils.ts`)
  - 날짜 포맷팅
  - 통화 포맷팅
- [ ] 공통 UI 컴포넌트
  - `StatusBadge` (상태별 색상 적용)
  - `Pagination` (재사용 가능한 페이지네이션)

### 왜 이 순서로 해야 하는가?
- 타입 정의가 선행되어야 모든 컴포넌트/함수에서 사용 가능
- Notion API 연동은 데이터 흐름의 시작점
- 매퍼는 API 응답을 안전하게 변환하여 앱 전체에서 사용
- 공통 컴포넌트가 없으면 페이지 개발 시 중복 작업 발생

### 완료 기준
- [ ] Notion API에서 데이터 조회 시 정상적으로 타입이 추론됨
- [ ] 매퍼 함수로 Notion 데이터가 올바르게 변환됨 (Zod 검증 통과)
- [ ] `StatusBadge`가 4가지 상태(작성중/발행됨/승인됨/거절됨) 모두 표시 가능
- [ ] 페이지네이션이 total/page/limit을 받아 렌더링 가능

---

## Phase 3: 핵심 기능 개발

**예상 소요 시간:** 3일

### 작업 내용

#### 3.1 API 엔드포인트 개발
- [ ] `GET /api/invoices` - 견적서 목록 조회
  - 쿼리 파라미터: `status`, `search`, `page`, `limit`
  - 페이지네이션 응답 포함
- [ ] `GET /api/invoices/[id]` - 견적서 상세 조회
- [ ] 에러 핸들링 (401, 404, 429, 500)

#### 3.2 인증 시스템
- [ ] 미들웨어 토큰 검증 (`src/middleware.ts`)
  - `/invoices/*`, `/api/invoices/*` 경로 보호
  - 토큰 불일치 시 루트로 리다이렉트
- [ ] 인증 페이지 (`/`) - 토큰 입력 폼
- [ ] URL 토큰 유지 및 전달 로직

#### 3.3 견적서 목록 페이지 (`/invoices`)
- [ ] 페이지 레이아웃 구성
- [ ] 필터/검색 바 (`FilterBar`)
- [ ] 반응형 목록 구현
  - 데스크톱: `InvoiceTable`
  - 모바일: `InvoiceCard`
- [ ] 데이터 페칭 및 상태 관리

#### 3.4 견적서 상세 페이지 (`/invoices/[id]`)
- [ ] 상세 정보 레이아웃 (`InvoiceDetail`)
  - 헤더: 견적번호, 발행일, 유효기간, 상태
  - 클라이언트 정보, 프로젝트명
  - 품목 테이블
  - 합계 섹션 (소계, 세금, 총액)
- [ ] 뒤로 가기 버튼
- [ ] 데이터 페칭

### 왈 이 순서로 해야 하는가?
- API가 먼저 개발되어야 클라이언트에서 테스트 가능
- 인증은 모든 보호된 페이지의 진입점이므로 선행 필요
- 목록 → 상세는 사용자 흐름의 자연스러운 순서
- 핵심 가치(견적서 조회)를 먼저 제공하여 빠른 피드백 가능

### 완료 기준
- [ ] 토큰 없이 `/invoices` 접근 시 인증 페이지로 리다이렉트
- [ ] 올바른 토큰으로 목록 페이지 접근 가능
- [ ] 목록에서 상세 페이지로 이동 가능
- [ ] 견적서 상세 정보가 정확히 표시됨
- [ ] 10개 이상 데이터 시 페이지네이션 동작

---

## Phase 4: 추가 기능 개발

**예상 소요 시간:** 2일

### 작업 내용

#### 4.1 PDF 다운로드 기능
- [ ] `react-to-print` 연동
- [ ] 인쇄용 컴포넌트 (`InvoicePrint`)
  - A4 크기 최적화
  - 인쇄 스타일 적용 (`@media print`)
- [ ] PDF 다운로드 버튼 구현
- [ ] 파일명: `견적서_{invoiceNumber}.pdf`

#### 4.2 필터링 및 검색
- [ ] 상태별 필터링 ("전체", "작성중", "발행됨", "승인됨", "거절됨")
- [ ] 고객명/프로젝트명 검색
  - 디바운스 300ms 적용
- [ ] URL query parameter 동기화 (`?status=발행됨&search=xxx`)
- [ ] 필터/검색 결과 실시간 반영

#### 4.3 에러 처리 및 로딩 상태
- [ ] 로딩 스피너/스켈레톤 UI
- [ ] 에러 페이지 (404, 500)
- [ ] 재시도 기능
- [ ] Notion API Rate Limit 대응 UI

### 왜 이 순서로 해야 하는가?
- PDF는 클라이언트 핵심 니즘이지만, 데이터 조회 없이는 테스트 불가
- 필터링/검색은 목록 페이지가 완성된 후에 적용 가능
- 에러 처리는 모든 기능 완료 후 일괄 적용이 효율적

### 완료 기준
- [ ] PDF 다운로드 버튼 클릭 시 브라우저 인쇄 다이얼로그 열림
- [ ] 상태 필터 변경 시 목록 필터링됨
- [ ] 검색어 입력 시 300ms 후 필터링됨
- [ ] 필터/검색 상태가 URL에 반영되고 새로고침 시 유지됨
- [ ] Notion API 오류 시 사용자 친화적인 에러 메시지 표시

---

## Phase 5: 최적화 및 배포

**예상 소요 시간:** 1일

### 작업 내용

#### 5.1 성능 최적화
- [ ] Notion API 캐싱 (ISR 60초)
- [ ] 이미지 최적화 (필요 시)
- [ ] 번들 사이즈 분석 및 최적화
- [ ] Lighthouse 점수 확인 (목표: 90점 이상)

#### 5.2 테스트
- [ ] 크로스 브라우저 테스트 (Chrome, Safari, Firefox)
- [ ] 모바일 반응형 테스트
- [ ] PDF 출력 테스트
- [ ] 토큰 인증 플로우 테스트

#### 5.3 배포
- [ ] Vercel 프로젝트 생성
- [ ] 환경변수 설정 (Production)
- [ ] 도메인 연결 (필요 시)
- [ ] 프로덕션 빌드 검증

#### 5.4 모니터링
- [ ] Vercel Analytics 설정
- [ ] 에러 로깅 설정 (선택)

### 왜 이 순서로 해야 하는가?
- 최적화 없이 배포 시 성능 이슈 발생 가능
- 테스트 후 발견된 버그는 배포 전에 수정해야 함
- 프로덕션 환경변수는 마지막에 설정하여 보안 유지

### 완료 기준
- [ ] Lighthouse Performance 점수 90점 이상
- [ ] 초기 로딩 3초 이내
- [ ] PDF 출력이 A4에 정확히 맞춰짐
- [ ] 프로덕션 URL에서 모든 기능 정상 동작
- [ ] 모바일/데스크톱 모두 정상 표시

---

## 개발 일정 요약

| Phase | 단계명 | 예상 소요 | 누적 일수 |
|-------|--------|-----------|----------|
| 1 | 프로젝트 초기 설정 | 1일 | 1일 |
| 2 | 공통 모듈/컴포넌트 | 1일 | 2일 |
| 3 | 핵심 기능 개발 | 3일 | 5일 |
| 4 | 추가 기능 개발 | 2일 | 7일 |
| 5 | 최적화 및 배포 | 1일 | 8일 |

**총 예상 소요: 8일 (약 1.5주)**

---

## 의존성 그래프

```
Phase 1: 프로젝트 설정
    ↓
Phase 2: 공통 모듈 (타입, Notion API, 매퍼, 공통 컴포넌트)
    ↓
Phase 3: 핵심 기능 (API → 인증 → 목록/상세 페이지)
    ↓
Phase 4: 추가 기능 (PDF, 필터/검색, 에러 처리)
    ↓
Phase 5: 최적화 및 배포
```

---

## 체크포인트

각 Phase 완료 후 아래 사항을 확인하세요:

- [ ] **Phase 1 완료**: 개발 서버 구동 및 환경변수 확인
- [ ] **Phase 2 완료**: Notion 데이터 조회 및 타입 변환 테스트
- [ ] **Phase 3 완료**: 인증 → 목록 → 상세 플로우 E2E 테스트
- [ ] **Phase 4 완료**: PDF 출력 및 필터/검색 기능 검증
- [ ] **Phase 5 완료**: 프로덕션 배포 및 성능 측정

---

*문서 버전: 1.0*
*작성일: 2026-02-21*
*기준 PRD: Invoice Web MVP PRD v1.0*
